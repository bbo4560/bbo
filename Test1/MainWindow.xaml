<Window x:Class="Test1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="練習" Height="500" Width="940"  Cursor="">
    <Grid Margin="20" Cursor="">
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#f4f7fb" Offset="0" />
                <GradientStop Color="#dde6f7" Offset="1" />
            </LinearGradientBrush>
        </Grid.Background>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <TextBlock x:Name="txtUpdateTime"
           Text="最後更新時間:尚未有資料更新"
           HorizontalAlignment="Right"
           VerticalAlignment="Top"
           Margin="0,10,5,0"
           FontSize="13"
           Foreground="#888"
           Grid.Row="0"/>

        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,4,0,4" Cursor="">
            <Button x:Name="btnAdd" FontSize="18" Height="38" Width="90"
                    Content="新增" Click="OpenAddWindow" Margin="0,0,8,0"
                    Style="{StaticResource MaterialDesignRaisedButton}"/>
            <Button FontSize="18" Height="38" Width="90"
                    Content="查詢" Click="OpenSearchWindow" Margin="0,0,8,0"
                    Style="{StaticResource MaterialDesignRaisedButton}" Cursor="Hand"/>
            <Button x:Name="btnImport" FontSize="18" Height="38" Width="90"
                    Content="匯入" Click="ImportExcel_Click" Margin="0,0,8,0"
                    Style="{StaticResource MaterialDesignRaisedButton}" Cursor="Hand"/>
            <Button x:Name="btnExport" FontSize="18" Height="38" Width="90"
                    Content="匯出" Click="ExportExcel_Click" Margin="0,0,8,0"
                    Style="{StaticResource MaterialDesignRaisedButton}" Cursor="Hand"/>

            <Button FontSize="18" Height="38" Width="140"
                    Content="查看操作紀錄" Click="ShowOperationLogWindow" Margin="0,0,8,0"
                    Style="{StaticResource MaterialDesignRaisedButton}" Cursor="Hand"/>
        </StackPanel>

        <DataGrid x:Name="LogsDataGrid"
          ItemsSource="{Binding Logs}"
          AutoGenerateColumns="False"
          Grid.Row="1"
          Margin="0,6,0,0"
          FontSize="18"                  
          HorizontalAlignment="Stretch"
          VerticalAlignment="Stretch"
          CanUserAddRows="False"
          HeadersVisibility="Column" 
          IsReadOnly="True"
          AlternatingRowBackground="#e8eefc"
          RowBackground="White"
          GridLinesVisibility="All"
          FontFamily="Microsoft JhengHei"
          SelectionMode="Extended"
          SelectionUnit="FullRow">
            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="FontWeight" Value="Bold"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Setter Property="Foreground" Value="Black"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#FFE3F2FD"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>


            <DataGrid.Columns>
                <DataGridTextColumn Header="Time"
                                    Binding="{Binding TimeFormatted, UpdateSourceTrigger=PropertyChanged}"
                                    Width="350" IsReadOnly="True"/>
                <DataGridTextColumn Header="PanelID"
                                    Binding="{Binding Panel_ID, UpdateSourceTrigger=PropertyChanged}"
                                    Width="*" IsReadOnly="False"/>
                <DataGridTextColumn Header="LOTID"
                                    Binding="{Binding LOT_ID, UpdateSourceTrigger=PropertyChanged}"
                                    Width="*" IsReadOnly="False"/>
                <DataGridTextColumn Header="CarrierID"
                                    Binding="{Binding Carrier_ID, UpdateSourceTrigger=PropertyChanged}"
                                    Width="*" IsReadOnly="False"/>
                <DataGridTemplateColumn Header="操作" Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button x:Name="btnDelete" FontSize="16" Content="刪除"
                                        Command="{Binding DataContext.DeleteLogCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding}" 
                                        Height="32" Width="60" Margin="2,0"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Foreground="#D32F2F"
                                        Padding="4,0"
                                        IsEnabled="{Binding DataContext.CanDelete, RelativeSource={RelativeSource AncestorType=Window}}"/>
                                <Button x:Name="btnEdit" FontSize="16" Content="修改"
                                        Command="{Binding DataContext.UpdateLogCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding}" 
                                        Height="32" Width="60" Margin="2,0"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Foreground="Black"
                                        Padding="4,0"
                                        IsEnabled="{Binding DataContext.CanEdit, RelativeSource={RelativeSource AncestorType=Window}}"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Window>

